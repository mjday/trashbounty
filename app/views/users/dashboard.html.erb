<!-- Users will have different Dashboard views -->

<!-- renders Collector Users Dashboard  -->
<% if @user.business == false %>
  <div class="container">
    <section id="tabs">
    <div class="container">
      <div class="row justify-content-center align-items-center">
        <div class="col-xs-12 col-md-12 col-12">

          <!-- Profile Card -->
          <div class="card promoting-card my-3">
            <!-- Card content -->
            <div class="card-body d-flex flex-row">
              <% if @user.photo? %>
                <%= cl_image_tag @user.photo.url(:thumb) %>
              <% else %>
                <%= image_tag "default-avatar.png", class: "mr-3 avatar-bordered" %>
              <% end %>
              <div>

                <h4 class="card-title font-weight-bold mb-2">Welcome, <%= @user.username %></h4>
                <%= link_to "Rank", leaderboard_path %>
                <p class="card-text"></p>
              </div>
            </div>
          </div> <!-- End Profile Card -->

          <!-- Dashboard Card -->
          <div class="card chart-card">
            <!-- Card content -->
            <div class="card-body pb-0">
              <h4 class="card-title font-weight-bold">Current Status</h4>

              <p class="card-text mb-4">Total Plastic Collected</p>

              <div class="d-flex row">
                  <p class="ml-3 display-4 align-self-end"><%# sum += collection.total_kg %><%= @sum %></p>
                <p class="ml-2 align-self-end pb-2">Collected (Kg)</p>
              </div>
            </div>
            <!-- End Card content -->

            <!-- Dashboard Nav -->
            <nav>
              <div class="nav nav-tabs nav-fill" id="nav-tab" role="tablist">
                <a class="nav-item nav-link active" id="nav-summary-tab" data-toggle="tab" href="#nav-summary" role="tab" aria-controls="nav-summary" aria-selected="true">Summary</a>
                <a class="nav-item nav-link" id="nav-collections-tab" data-toggle="tab" href="#nav-collections" role="tab" aria-controls="nav-collections" aria-selected="false">Collections</a>
              </div>
            </nav>

            <!-- Tabs section -->
            <div class="tab-content py-3 px-3 px-sm-0" id="nav-tabContent">
              <!-- Summary Tab -->
              <div class="tab-pane fade show active" id="nav-summary" role="tabpanel" aria-labelledby="nav-summary-tab">
                <div id="line_chart" class="chart" style="width: 100vw; height: 50vh;">
              </div>
</div>

              </div>
              <!-- Collection History Tab -->
              <div class="tab-pane fade" id="nav-collections" role="tabpanel" aria-labelledby="nav-collections-tab">
                <p>Open your Camera App to scan the QR code shown by the Recycle Bank</p>

                <table id="dtDynamicVerticalScrollExample" class="table table-striped table-bordered table-sm" cellspacing="0" width="100%">
                  <thead>
                    <tr>
                      <th class="th-sm">#</th>
                      <th class="th-sm">Date</th>
                      <th class="th-sm">Total Kg</th>
                      <th class="th-sm">Amount ($)</th>
                      <th class="th-sm">Payment Type</th>
                    </tr>
                  </thead>
                  <tbody id='info'>
                    <% counter = 0 %>
                    <% @user.collections.each do |collection| %>
                    <tr >
                      <td><%= link_to counter += 1, collection_path(collection.id) %></td>
                      <td class="data-date"><%= collection.date.strftime("%b %d, %Y") %></td>
                      <td class="data-kg"><%= collection.total_kg %></td>
                      <td class="data-amount"><%= collection.total_amount %></td>



                      <td><%= collection.payment_type %></td>
<!--                   <td><%= link_to new_collection_review_path(collection), class: "fas fa-star" %></td>
 -->
                    </tr>
                    <% end %>
                  </tbody>
                </table>

              </div> <!-- End Collection History Tab -->
            </div> <!-- end Tabs content -->
            </div>
            <!-- End Card content -->
          </div> <!-- End Dashboard Card -->

        </div> <!-- end col-xs-12 -->
      </div> <!-- end row -->
    </div> <!-- end container -->
  </div> <!-- Collector Dashboard Container -->

<% else %>

  <!-- renders Business (Recycle Bank) Users Dashboard  -->
  <div class="container">
    <section id="tabs">
    <div class="container">
      <div class="row justify-content-center align-items-center">
        <div class="col-xs-12 ">
          <h6 class="section-title h1">Recycle Bank Dashboard</h6>
          <nav>
            <div class="nav nav-tabs nav-fill" id="nav-tab" role="tablist">
              <a class="nav-item nav-link active" id="nav-bank-tab" data-toggle="tab" href="#nav-bank" role="tab" aria-controls="nav-bank" aria-selected="true">Recycle Banks</a>
              <a class="nav-item nav-link" id="nav-verification-tab" data-toggle="tab" href="#nav-verification" role="tab" aria-controls="nav-verification" aria-selected="false">Verifications</a>
            </div>
          </nav>
          <!-- Recycle Center Tab -->
          <div class="tab-content py-3 px-3 px-sm-0" id="nav-tabContent">
            <div class="tab-pane fade show active" id="nav-bank" role="tabpanel" aria-labelledby="nav-bank-tab">
                <!-- table here -->
                <table id="dtDynamicVerticalScrollExample" class="table table-striped table-bordered table-sm" cellspacing="0" width="100%">
                  <thead>
                    <tr>
                      <th class="th-sm">#</th>
                      <th class="th-sm">My Recycle Center</th>
                      <th class="th-sm">Verify</th>
                    </tr>
                  </thead>
                  <tbody>
                  <% counter = 0 %>
                  <% @banks.each do |bank| %>
                  <tr>
                    <td><%= counter = counter + 1 %></td>
                    <td><%= link_to bank.name, bank_path(bank) %></td>
                    <%# raise  %>
                    <td class="text-center">
                      <%= link_to new_bank_verification_path(bank) do %>
                        <i class="fas fa-qrcode"></i>
                          <!-- new_bank_verification
                          GET  /banks/:bank_id/verifications/new -->
                      <% end %>
                    </td>
                  </tr>
                  <% end %>
                </table>

                  <%= link_to 'List a recycling center', new_bank_path, class: "btn btn-warning" %>
            </div>
            <!-- Transactions Tab -->
            <div class="tab-pane fade" id="nav-verification" role="tabpanel" aria-labelledby="nav-verification-tab">
               <p>View Verification history</p>
            </div>

          </div> <!-- end Tabs content -->
        </div> <!-- end col-xs-12 -->
      </div> <!-- end row -->
    </div> <!-- end container -->
  </div> <!-- Business (Recycle Bank) Dashboard Container -->

<% end %>





